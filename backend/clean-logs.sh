#!/bin/bash

echo "ðŸ§¹ æ—¥å¿—æ¸…ç†å·¥å…·"
echo "================"

# æ£€æŸ¥logsç›®å½•æ˜¯å¦å­˜åœ¨
if [ ! -d "logs" ]; then
    echo "âŒ logsç›®å½•ä¸å­˜åœ¨"
    exit 1
fi

echo "ðŸ“ å½“å‰æ—¥å¿—æ–‡ä»¶ï¼š"
ls -la logs/sql-*.log 2>/dev/null || echo "æ²¡æœ‰æ‰¾åˆ°SQLæ—¥å¿—æ–‡ä»¶"

echo ""
echo "ðŸ—‘ï¸  æ¸…ç†é€‰é¡¹ï¼š"
echo "1. æ¸…ç†æ‰€æœ‰æ—¥å¿—æ–‡ä»¶"
echo "2. æ¸…ç†7å¤©å‰çš„æ—¥å¿—æ–‡ä»¶"
echo "3. æ¸…ç†30å¤©å‰çš„æ—¥å¿—æ–‡ä»¶"
echo "4. åªæ¸…ç†ä»Šå¤©çš„æ—¥å¿—æ–‡ä»¶"
echo "5. é€€å‡º"

read -p "è¯·é€‰æ‹©æ“ä½œ (1-5): " choice

case $choice in
    1)
        echo "ðŸ—‘ï¸  æ¸…ç†æ‰€æœ‰æ—¥å¿—æ–‡ä»¶..."
        rm -f logs/sql-*.log
        echo "âœ… æ‰€æœ‰æ—¥å¿—æ–‡ä»¶å·²æ¸…ç†"
        ;;
    2)
        echo "ðŸ—‘ï¸  æ¸…ç†7å¤©å‰çš„æ—¥å¿—æ–‡ä»¶..."
        find logs/ -name "sql-*.log" -mtime +7 -delete
        echo "âœ… 7å¤©å‰çš„æ—¥å¿—æ–‡ä»¶å·²æ¸…ç†"
        ;;
    3)
        echo "ðŸ—‘ï¸  æ¸…ç†30å¤©å‰çš„æ—¥å¿—æ–‡ä»¶..."
        find logs/ -name "sql-*.log" -mtime +30 -delete
        echo "âœ… 30å¤©å‰çš„æ—¥å¿—æ–‡ä»¶å·²æ¸…ç†"
        ;;
    4)
        echo "ðŸ—‘ï¸  æ¸…ç†ä»Šå¤©çš„æ—¥å¿—æ–‡ä»¶..."
        TODAY=$(date +%Y-%m-%d)
        rm -f logs/sql-${TODAY}.log
        echo "âœ… ä»Šå¤©çš„æ—¥å¿—æ–‡ä»¶å·²æ¸…ç†"
        ;;
    5)
        echo "ðŸ‘‹ é€€å‡º"
        exit 0
        ;;
    *)
        echo "âŒ æ— æ•ˆé€‰æ‹©"
        exit 1
        ;;
esac

echo ""
echo "ðŸ“ æ¸…ç†åŽçš„æ—¥å¿—æ–‡ä»¶ï¼š"
ls -la logs/sql-*.log 2>/dev/null || echo "æ²¡æœ‰æ‰¾åˆ°SQLæ—¥å¿—æ–‡ä»¶" 